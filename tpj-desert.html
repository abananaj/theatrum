<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <title>CodePen - tpj gallery desert</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            background-color: black;
            box-sizing: border-box;
        }

        .gallery-track {
            position: fixed;
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: .1rem;
            padding: 0.25rem;
            will-change: transform;
        }

        .card {
            height: 400px;
            overflow: hidden;

            & .card-image-wrapper {
                height: 135%;
                will-change: transform;

                & img {
                    width: 100%;
                    height: 100%;
                    object-fit: cover;
                }
            }
        }

        @media (width < 800px) {
            .gallery-track {
                grid-template-columns: repeat(2, 1fr);
            }
        }

        @media (width < 550px) {
            .gallery-track {
                grid-template-columns: repeat(1, 1fr);
            }
        }
    </style>

</head>

<body>
    <!-- partial:index.partial.html -->
    <main class='gallery'>
        <div class='gallery-track'>
            <div class='card'>
                <div class='card-image-wrapper'>
                    <img src='https://mundi.s3.us-west-1.amazonaws.com/tpj/desert/12.jpg'>
                </div>
            </div>
            <div class='card'>
                <div class='card-image-wrapper'>
                    <img src='https://mundi.s3.us-west-1.amazonaws.com/tpj/desert/15.jpg'>
                </div>
            </div>
            <div class='card'>
                <div class='card-image-wrapper'>
                    <img src='https://mundi.s3.us-west-1.amazonaws.com/tpj/desert/22.jpg'>
                </div>
            </div>
            <div class='card'>
                <div class='card-image-wrapper'>
                    <img src='https://mundi.s3.us-west-1.amazonaws.com/tpj/desert/3.jpg'>
                </div>
            </div>
            <div class='card'>
                <div class='card-image-wrapper'>
                    <img src='https://mundi.s3.us-west-1.amazonaws.com/tpj/alhambra-mex-hat/4.jpeg'>
                </div>
            </div>
            <div class='card'>
                <div class='card-image-wrapper'>
                    <img src='https://mundi.s3.us-west-1.amazonaws.com/tpj/desert/5.jpg'>
                </div>
            </div>
            <div class='card'>
                <div class='card-image-wrapper'>
                    <img src='https://mundi.s3.us-west-1.amazonaws.com/tpj/desert/32.jpg'>
                </div>
            </div>
            <div class='card'>
                <div class='card-image-wrapper'>
                    <img src='https://mundi.s3.us-west-1.amazonaws.com/tpj/desert/34.jpg'>
                </div>
            </div>
            <div class='card'>
                <div class='card-image-wrapper'>
                    <img src='https://mundi.s3.us-west-1.amazonaws.com/tpj/goblin-valley/7.jpg'>
                </div>
            </div>
            <div class='card'>
                <div class='card-image-wrapper'>
                    <img src='https://mundi.s3.us-west-1.amazonaws.com/tpj/desert/9.jpg'>
                </div>
            </div>
            <div class='card'>
                <div class='card-image-wrapper'>
                    <img src='https://mundi.s3.us-west-1.amazonaws.com/tpj/desert/10.jpg'>
                </div>
            </div>
            <div class='card'>
                <div class='card-image-wrapper'>
                    <img src='https://mundi.s3.us-west-1.amazonaws.com/tpj/desert/11.jpg'>
                </div>
            </div>
            <div class='card'>
                <div class='card-image-wrapper'>
                    <img src='https://mundi.s3.us-west-1.amazonaws.com/tpj/desert/42.jpg'>
                </div>
            </div>
            <div class='card'>
                <div class='card-image-wrapper'>
                    <img src='https://mundi.s3.us-west-1.amazonaws.com/tpj/desert/38.jpg'>
                </div>
            </div>
            <div class='card'>
                <div class='card-image-wrapper'>
                    <img src='https://mundi.s3.us-west-1.amazonaws.com/tpj/desert/14.jpg'>
                </div>
            </div>

            <div class='card'>
                <div class='card-image-wrapper'>
                    <img src='https://mundi.s3.us-west-1.amazonaws.com/tpj/desert/16.jpg'>
                </div>
            </div>
            <div class='card'>
                <div class='card-image-wrapper'>
                    <img src='https://mundi.s3.us-west-1.amazonaws.com/tpj/desert/17.jpg'>
                </div>
            </div>
            <div class='card'>
                <div class='card-image-wrapper'>
                    <img src='https://mundi.s3.us-west-1.amazonaws.com/tpj/alhambra-mex-hat/1.jpeg'>
                </div>
            </div>
            <div class='card'>
                <div class='card-image-wrapper'>
                    <img src='https://mundi.s3.us-west-1.amazonaws.com/tpj/highway-12/2.jpg'>
                </div>
            </div>

            <div class='card'>
                <div class='card-image-wrapper'>
                    <img src='https://mundi.s3.us-west-1.amazonaws.com/tpj/desert/20.jpg'>
                </div>
            </div>
            <div class='card'>
                <div class='card-image-wrapper'>
                    <img src='https://mundi.s3.us-west-1.amazonaws.com/tpj/desert/33.jpg'>
                </div>
            </div>
            <div class='card'>
                <div class='card-image-wrapper'>
                    <img src='https://mundi.s3.us-west-1.amazonaws.com/tpj/goblin-valley/4.jpg'>
                </div>
            </div>
            <div class='card'>
                <div class='card-image-wrapper'>
                    <img src='https://mundi.s3.us-west-1.amazonaws.com/tpj/desert/23.jpg'>
                </div>
            </div>
            <div class='card'>
                <div class='card-image-wrapper'>
                    <img src='https://mundi.s3.us-west-1.amazonaws.com/tpj/desert/24.jpg'>
                </div>
            </div>
        </div>
    </main>
    <!-- partial -->
    <script>const gallery = document.querySelector('.gallery');
        const track = document.querySelector('.gallery-track');
        const cards = document.querySelectorAll('.card');
        const easing = 0.05;
        let startY = 0;
        let endY = 0;
        let raf;

        const lerp = (start, end, t) => start * (1 - t) + end * t;

        function updateScroll() {
            startY = lerp(startY, endY, easing);
            gallery.style.height = `${track.clientHeight}px`;
            track.style.transform = `translateY(-${startY}px)`;
            activateParallax();
            raf = requestAnimationFrame(updateScroll);
            if (startY.toFixed(1) === window.scrollY.toFixed(1)) cancelAnimationFrame(raf);
        }

        function startScroll() {
            endY = window.scrollY;
            cancelAnimationFrame(raf);
            raf = requestAnimationFrame(updateScroll);
        }

        function parallax(card) {
            const wrapper = card.querySelector('.card-image-wrapper');
            const diff = card.offsetHeight - wrapper.offsetHeight;
            const { top } = card.getBoundingClientRect();
            const progress = top / window.innerHeight;
            const yPos = diff * progress;
            wrapper.style.transform = `translateY(${yPos}px)`;
        }

        const activateParallax = () => cards.forEach(parallax);

        function init() {
            activateParallax();
            startScroll();
        }

        window.addEventListener('load', updateScroll, false);
        window.addEventListener('scroll', init, false);
        window.addEventListener('resize', updateScroll, false);</script>

</body>

</html>